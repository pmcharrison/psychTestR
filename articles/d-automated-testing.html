<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial (intermediate): Automated testing • psychTestR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial (intermediate): Automated testing">
<meta property="og:description" content="psychTestR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psychTestR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.24.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a1-simple-demo.html">Demos</a>
    </li>
    <li>
      <a href="../articles/a2-research-examples.html">Research examples</a>
    </li>
    <li>
      <a href="../articles/b-introduction.html">An introduction to psychTestR</a>
    </li>
    <li>
      <a href="../articles/c-media-files.html">Tutorial (basic): Media files</a>
    </li>
    <li>
      <a href="../articles/c-modularisation.html">Tutorial (basic): Modularisation</a>
    </li>
    <li>
      <a href="../articles/d-automated-testing.html">Tutorial (intermediate): Automated testing</a>
    </li>
    <li>
      <a href="../articles/d-building-custom-page-types.html">Tutorial (intermediate): Building custom page types</a>
    </li>
    <li>
      <a href="../articles/d-editing-dictionaries.html">Tutorial (intermediate): Editing dictionaries</a>
    </li>
    <li>
      <a href="../articles/d-hosting-experiments-online.html">Tutorial (intermediate): Hosting experiments online</a>
    </li>
    <li>
      <a href="../articles/d-randomisation.html">Tutorial (intermediate): Randomising item administration</a>
    </li>
    <li>
      <a href="../articles/d-url-parameters.html">Tutorial (intermediate): URL parameters</a>
    </li>
    <li>
      <a href="../articles/e-internationalised-questionnaire.html">Tutorial (expert): Creating an internationalised questionnaire</a>
    </li>
    <li>
      <a href="../articles/e-jspsych-integration.html">Tutorial (expert): jsPsych integration</a>
    </li>
    <li>
      <a href="../articles/z_Anthony_Chmiel_video_tutorials.html">Video series: An introduction to psychTestR, by Anthony Chmiel</a>
    </li>
    <li>
      <a href="../articles/z_code_for_article_in_musik_und_internet.html">Code for Article 'psychTestR - Ein R-Paket für (musik-) psychologische Tests und Fragebogeninventare'</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pmcharrison/psychTestR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tutorial (intermediate): Automated testing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pmcharrison/psychTestR/blob/HEAD/vignettes/d-automated-testing.Rmd" class="external-link"><code>vignettes/d-automated-testing.Rmd</code></a></small>
      <div class="hidden name"><code>d-automated-testing.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Automated testing is essential in modern software development. In the
context of psychological experiment development, automated tests help
you to ensure the robustness of your experiment’s implementation without
having to invest tedious hours in manual testing.</p>
<p>To construct an automated test in psychTestR, you first need a test
implementation saved in a file named <code>app.R</code>. Suppose we’ve
implemented the following minimal example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pmcharrison/psychTestR" class="external-link">psychTestR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">display_number</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Page"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">timeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join.html">join</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="va">display_number</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/final_page.html">final_page</a></span><span class="op">(</span><span class="st">"End."</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_test.html">make_test</a></span><span class="op">(</span><span class="va">timeline</span>, opt <span class="op">=</span> <span class="fu"><a href="../reference/test_options.html">test_options</a></span><span class="op">(</span><span class="st">"Minimal test"</span>, <span class="st">"password"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now make a new file, called <code>test.R</code> (or whatever you
want). Within this file, we construct an automated tester using the
<code>AppTester</code> class:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pmcharrison/psychTestR" class="external-link">psychTestR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"demos/minimal-test"</span>, package <span class="op">=</span> <span class="st">"psychTestR"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">app</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppTester.html">AppTester</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span></code></pre></div>
<p>We’ve put a sample <code>app.R</code> file in the psychTestR package,
and the above example finds that file using <code>system.file</code>; to
point the code to your own <code>app.R</code> file, simply replace the
<code>system.file</code> call with the path to the directory containing
your <code>app.R</code> file.</p>
<p>This <code>AppTester</code> object instantiates a headless browser
which then navigates your psychTestR test, just like a real participant.
This object has various methods that are useful for interacting with the
psychTestR test and probing its internal state. For example, we can
probe the current UI text:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span><span class="op">$</span><span class="fu">get_ui_text</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Page 1 Next"</span></span></code></pre>
<p>We can click the “Next” button:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">get_ui_text</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Page 2 Next"</span></span></code></pre>
<p>We can pull local variables:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $.module</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $.results_label</span></span>
<span><span class="co">## [1] "results"</span></span></code></pre>
<p>We can run assertions that throw an error if a given condition is not
satisfied:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"Page 2 Next"</span><span class="op">)</span></span></code></pre></div>
<p>And we can combine all of this together into an automated script that
checks that our test runs as expected:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span> <span class="co"># for the expect_equal function</span></span>
<span></span>
<span><span class="va">app</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppTester.html">AppTester</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">dir</span><span class="op">)</span></span>
<span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">expect_title</span><span class="op">(</span><span class="st">"Minimal test"</span><span class="op">)</span> <span class="co"># check the test's title</span></span>
<span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.module <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       .results_label <span class="op">=</span> <span class="st">"results"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Page %i Next"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"End."</span><span class="op">)</span></span>
<span></span>
<span><span class="va">app</span><span class="op">$</span><span class="kw">stop</span><span class="op">(</span><span class="op">)</span> <span class="co"># shuts down the testing process</span></span></code></pre></div>
<p>See <code><a href="../reference/AppTester.html">?AppTester</a></code> for more information on automated testing
utilities.</p>
</div>
<div class="section level2">
<h2 id="a-real-world-example">A real-world example<a class="anchor" aria-label="anchor" href="#a-real-world-example"></a>
</h2>
<p>The above example was rather simple, but automated testing comes into
its own with more complex implementations. Here is an example from the
test suite in the psychTestR package, designed to check that nested
modules work as intended.</p>
<div class="section level3">
<h3 id="the-app-tester">The app tester<a class="anchor" aria-label="anchor" href="#the-app-tester"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://testthat.r-lib.org/reference/context.html" class="external-link">context</a></span><span class="op">(</span><span class="st">"test_modules"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html" class="external-link">test_that</a></span><span class="op">(</span><span class="st">"main"</span>, <span class="op">{</span></span>
<span>  <span class="va">app</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/AppTester.html">AppTester</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"apps/modules"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"We begin in the global environment. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.module <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                         .results_label <span class="op">=</span> <span class="st">"results"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"We've now entered the parent environment. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.module <span class="op">=</span> <span class="st">"parent"</span>,</span>
<span>                                         .results_label <span class="op">=</span> <span class="st">"parent"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"In the parent environment, we define a local variable, x = 42. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"Now we enter the child environment. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.module <span class="op">=</span> <span class="st">"child"</span>,</span>
<span>                                         .results_label <span class="op">=</span> <span class="st">"parent.child"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"We can't see x any more: x is now NULL. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"We can set it to a new value, though: x = 65. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fl">65</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"Now we return to the parent environment. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.module <span class="op">=</span> <span class="st">"parent"</span>,</span>
<span>                                         .results_label <span class="op">=</span> <span class="st">"parent"</span>,</span>
<span>                                         x <span class="op">=</span> <span class="fl">42</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"We see that x = 42 again. Next"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"Now we return to the global environment. Next"</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.module <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                         .results_label <span class="op">=</span> <span class="st">"results"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">click_next</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">expect_ui_text</span><span class="op">(</span><span class="st">"We see that x is is NULL again."</span><span class="op">)</span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_locals</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="fu">get_results</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">42</span><span class="op">)</span>,</span>
<span>    parent.child <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">65</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">app</span><span class="op">$</span><span class="kw">stop</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-app-code">The app code<a class="anchor" aria-label="anchor" href="#the-app-code"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pmcharrison/psychTestR" class="external-link">psychTestR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">elts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/join.html">join</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"We begin in the global environment."</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/module.html">module</a></span><span class="op">(</span></span>
<span>    <span class="st">"parent"</span>,</span>
<span></span>
<span>    <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"We've now entered the parent environment."</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/code_block.html">code_block</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">state</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span>      <span class="fu"><a href="../reference/global_local.html">set_local</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="va">x</span>, <span class="va">state</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="../reference/save_result.html">save_result</a></span><span class="op">(</span><span class="va">state</span>, <span class="st">"x"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"In the parent environment, we define a local variable, x = 42."</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="fu"><a href="../reference/module.html">module</a></span><span class="op">(</span></span>
<span>      <span class="st">"child"</span>,</span>
<span>      <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"Now we enter the child environment."</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"We can't see x any more: x is now NULL."</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/code_block.html">code_block</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">state</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">65</span></span>
<span>        <span class="fu"><a href="../reference/global_local.html">set_local</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="va">x</span>, <span class="va">state</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="../reference/save_result.html">save_result</a></span><span class="op">(</span><span class="va">state</span>, <span class="st">"x"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"We can set it to a new value, though: x = 65."</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span></span>
<span>    <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"Now we return to the parent environment."</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"We see that x = 42 again."</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span></span>
<span>  <span class="fu"><a href="../reference/one_button_page.html">one_button_page</a></span><span class="op">(</span><span class="st">"Now we return to the global environment."</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/final_page.html">final_page</a></span><span class="op">(</span><span class="st">"We see that x is is NULL again."</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/make_test.html">make_test</a></span><span class="op">(</span><span class="va">elts</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Peter Harrison.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
